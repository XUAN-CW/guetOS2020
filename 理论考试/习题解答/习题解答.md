# 第二章

8、在道数不受限制的多道程序系统中，作业进入系统的后备队列时立即进行作业调度。现有4个作业进人系统，有关信息为

| 作业名 | 进入后备队列的时刻 | 执行时间/min | 优先数 |
| ------ | ------------------ | ------------ | ------ |
| Job1   | 8:00               | 60           | 1      |
| Job2   | 8:30               | 50           | 2      |
| Job3   | 8:40               | 30           | 4      |
| Job4   | 8:50               | 10           | 3      |

作业调度和进程调度均采用高优先算法（规定数值越大则优先越高）。试填充下表。

| 作业名 | 进入后备队列的时刻 | 执行时间/min | 开始执行时刻 | 结束执行时刻 | 周转时间/min | 带权周转时间/min |
| ------ | ------------------ | ------------ | ------------ | ------------ | ------------ | ---------------- |
|        |                    |              |              |              |              |                  |
|        |                    |              |              |              |              |                  |
|        |                    |              |              |              |              |                  |
|        |                    |              |              |              |              |                  |

| 平均周转时间T=     |
| ------------------ |
| 平均带权周转时间W= |



21、有一个具有三道作业的多道批处理系统，作业调度采用短作业优先调度算法，进程调度采用以优先数为基础的抢占式调度算法。在下表所示的作业序列中，作业优先数即为进程优先数，优先数越小则优先级越高。

| 作业名 | 到达时刻 | 估计运行时间/min | 优先数 |
| ------ | -------- | ---------------- | ------ |
| A      | 10:00    | 40               | 5      |
| B      | 10:20    | 30               | 3      |
| C      | 10:30    | 60               | 4      |
| D      | 10:50    | 20               | 6      |
| E      | 11:00    | 20               | 4      |
| F      | 11:10    | 10               | 4      |

试填充下表：

| 作业 | 进入内存时刻 | 运行结束时刻 | 作业周转时间/min |
| ---- | ------------ | ------------ | ---------------- |
| A    |              |              |                  |
| B    |              |              |                  |
| C    |              |              |                  |
| D    |              |              |                  |
| E    |              |              |                  |
| F    |              |              |                  |

平均作业周转时间：



23、有5个作业依次进入系统，其提交时刻、运行时间、作业长度分别为

| 作业 | 提交时刻 | 运行时间 | 作业长度/KB | 开始执行时刻 | 完成时刻 | 作业周转时间/min |
| ---- | -------- | -------- | ----------- | ------------ | -------- | ---------------- |
| Job1 | 10:00    | 25       | 15          |              |          |                  |
| Job2 | 10:20    | 30       | 60          |              |          |                  |
| Job3 | 10:20    | 25       | 40          |              |          |                  |
| Job4 | 10:30    | 15       | 20          |              |          |                  |
| Job5 | 10:35    | 10       | 30          |              |          |                  |

设内存容量为100KB，采用可变分区存储管理，且作业在内存中不能移动。作业调度采用先来先服务算法，作业所对应的进程调度采用内存中的就绪进程平分CPU时间的方式，不计作业对换及其他系统开销。试求各作业（进程）的开始执行时刻、完成时刻及周转时间。



27、某多道程序系统供用户使用的内存空间为100kb，磁带机2台，打印机1台。采用可变分区内存管理，采用静态方式分配外部设备，忽略用户业I/O操作时间。现有作业序列如下：

| 作业号 | 进入输入井时刻 | 运行时间/min | 内存需求量/KB | 磁带需求量/台 | 打印机需求量/台 |
| ------ | -------------- | ------------ | ------------- | ------------- | --------------- |
| 1      | 8:00           | 25           | 15            | 1             | 1               |
| 2      | 8:20           | 10           | 20            | 0             | 1               |
| 3      | 8:20           | 20           | 60            | 1             | 0               |
| 4      | 8:30           | 20           | 20            | 1             | 0               |
| 5      | 8:35           | 15           | 10            | 1             | 1               |

作业调度采用FCFS策略，优先分配内存低地址区且不准移动已在内存中的作业，内存中的各作业平分CPU时间。现求：（1）作业调度的先后次序；（2）全部作业运行结束的时刻；（3）作业平均周转时间；（4）最大作业周转时间。 

# 第三章

16、一个经典的同步问题：吸烟者问题（Patil，1971年）。三名吸烟者在同一个房间内，还有一位香烟供应者。为了制造并抽掉香烟，每位吸烟者需要三样东西：烟草、纸和火柴，供应者有丰富的货物提供。三位吸烟者中，第一个人有自己的烟草，第二个人有自己的纸，第三个人有自己的火柴。供应者随机地将两样东西放在桌子上，允许一位吸烟者进行对健康不利的吸烟。当吸烟者完成吸烟后唤醒供应者，供应者再把两样东西放在桌子上，唤醒另一位吸烟者。试采用（1）信号量和PV操作、（2）管程，编写他们同步工作的程序。



23、设当前的系统状态如下，此时Available=(1,1,2)。

|      | Claim                                                       | Allocation                                                   |
| ---- | ----------------------------------------------------------- | ------------------------------------------------------------ |
| 进程 | R1                          R2                         R3   | R1                          R2                         R3    |
| P1   | 3                             2                           2 | 1                            0                             0 |
| P2   | 6                             1                           3 | 5                            1                             1 |
| P3   | 3                             1                           4 | 2                            1                             1 |
| P4   | 4                             2                           2 | 0                            0                             2 |

（1）计算各个进程还需要的资源数Cki-Aki

（2）系统是否处于安全状态，为什么？

（3）进程P2发出请求向量 request2（1，0，1），系统能把资源分配给它吗？

（4）若在进程P2申请资源后，P1发出请求向量 request1（1，0，1），系统能把资源分配给它吗？

（5）若在进程P1申请资源后，P3发出请求向量 request3（0，0，1），系统能把资源分配给它吗？



25、把死锁检测算法用于下面的数据：
$$
Need=
 \begin{array}{|ccc|}
      1 & 1 & 0 &0 \\
      0& 1 & 1 &2 \\
      3 & 1 & 0 &0 \\
      0 & 0 & 1 &0 \\
      2 & 1 & 1 &0\\
    \end{array}
$$

$$
Allocation=
 \begin{array}{|ccc|}
      3 & 0 & 1 &1 \\
      0& 1 & 0 &0\\
      1 & 1 & 1 &0 \\
      1 & 1& 0&1 \\
       0 & 0 & 0 &0\\
    \end{array}
$$

​                                                                          Allocation  = (1,0,2,0)

（1）系统此时处于安全状态吗？（2）若第二个进程提出资源请求request2（0，0，1，0），系统能分配资源给它吗？

（3）若第五个进程提出资源请求request5（0，0，1，0），系统能分配资源给它吗？



26、考虑一个共有150个存储单元的系统，按如下方式分配给三个进程，P1最大需求70个，已占有25个；P2最大需求60个，已占有40个；P3最大需求60个，已占有45个。使用银行家算法以确定下面的任何一个请求是否安全：（1）进程P4到达，P4最大需求60个，最初请求25个。（2）进程P4到达，P4最大需求60个，最初请求35个。如果安全，请找出安全序列；如果不安全，请给出结果的分配情况。



31、独木桥问题1：东西向汽车驶过独木桥，为了保证交通安全，只要桥上无车，则允许一方的汽车过桥，待其全部过完后才允许另一方的汽车过桥。请用信号量和PV操作写出汽车过独木桥问题的同步算法。



32、独木桥问题2：在独木桥问题1中，限制桥面上最多可以有k辆汽车通过。试用信号量和PV操作写出汽车过独木桥问题的同步算法。




37、某工厂有两个生产车间和一个装配车间，两个生产车间分别生产A、B两种零件，装配车间的任务是把A、B两种零件组装成产品。两个生产车间每生产一个零件后都要分别把它们送到装配车间的货架F1、F2上，F1存放零件A，F2放零件B，F1和F2的容量均为可以存放10个零件。装配工人每次从货架上取一个A零件和一个B零件，然后将其组装成产品。请用：（1）信号量和PV操作进行正确管理；（2）管程进行正确管理。



38，桌上有一只盘子，最多可以容纳两个水果，每次仅能放入或取出一个水果。爸爸向盘子中放苹果（ apple），妈妈向盘子中放橘子（orange），两个儿子专等吃盘子里的橘子，两个女儿专等吃盘子里的苹果。试用（1）信号量和PV操作、（2）管程，来实现爸爸、妈妈、儿子、女儿间的同步与互斥关系。



43、现有三个生产者P1、P2、P3，他们都要生产橘子汁，每个生产者都已分别购得两种不同的原料，待购齐第三种原料后就可配制成橘子汁装瓶出售。有一供应商能源源不断地供应糖、水、橘子精，但每次只拿出一种原料放入容器中供应给生产者。当容器中有原料时，需要这种原料的生产者可以取走，当容器空时供应商又可放入一种原料。假定：生产者P1已购得糖和水；生产者P2已购得水和橘子精；生产者P3已购得糖和橘子精。试用（1）管程、（2）信号量与PV操作，写出供应商和三个生产者之间能正确同步的程序。

# 第四章

## 15

在一分页存储管理系统中，逻辑地址长度为16位，页面大小为4096B，现有逻辑地址2F6AH，且第0、1、2页依次存放在第10、12、14号物理块中，试问相应的物理地址是多少？

> 页面大小为4096字节，4096等于2的12次方。故页内地址为12位。又逻辑地址长度为16位。故高4位表示页号。则逻辑地址2F6AH在第2页。根据页表可知，第2页存于第14块中。14的十六进制为EH，与低12位F6AH拼接得物理地址为EF6AH

## 20

在一个分页虚拟存储系统中，用户编程空间为32个页，页长1KB，内存空间为16KB。如果应用程序有10页长，若已知虚页0、1、2、3，已分得页框4、7、8、10，试把虚地址0AC5H和1AC5H转换成对应的物理地址。

> 虚地址 0AC5H 对应的物理地址为：12C5H
> 虚地址 1AC5H 会发现页表中尚未有分配的页框而发生缺页中断，由系统另行分配页框
>
> --------------------------------------------------------------------------------------------------------
>
> 分析在分页存储管理方式中，逻辑地址结构=页号p+页内地址d
> 如果给定的逻辑地址是A，页面大小为L，则页号 p 和页内地址 d 可按下式求得：
> ​    p=int[A/L] 
> ​    d=[A]mod L 
> 其中，int 表示取结果的整数部分，mod表示取结果的余数部分。
>
> 页号的位数表示地址空间中最多可容纳的页面个数，页内地址位数表示页的大小，页表的作用是实现从页号到物理块号的地址映射。在页式存储管理中，逻辑空间页的大小与主存地址空间中块的大小相同。
> 一般，物理地址与页号、块号和页内地址之间存在关系：物理地址=块的大小(页的大小L)*块号+页内地址d
>
> 解:页式存储管理的逻辑地址分为两部分:页号和页内地址。
> 由已知条件"用户编程空间共32个页面"，可知页号部分占5位;由"每页为1KB"，1K=2<sup>10</sup>，可知内页地址占10位。由“内存为16KB"，可知有16块，块号为4位。
> 逻辑地址0AC5(H)所对应的二进制表示形式是:000 10<u>10 1100 0101</u> ，根据上面的分析，下划线部分为页内地址，编码“000 10”为页号，表示该逻辑地址对应的页号为2。查页表，得到物理块号是8(十进制)，即物理块地址为: 01000 ，拼接块内地址<u>010 1100 0101</u>，得**010 00<u>10 1100 0101</u>** ，即 225C(H)。
> 逻辑地址OA5C(H)所对应的物理地址是12C5(H)。
>
> 
>
> 逻辑地址1AC5(H)所对应的二进制表示形式是:001 10<u>10 1100 0101</u> ，根据上面的分析，下划线部分为页内地址，编码“001 10”为页号，表示该逻辑地址对应的页号为6。查页表，查不到，而发生缺页中断，由系统另行分配页框



25、一个有快表的页式虚拟存储系统，设内存访问周期为1us，主外存传送一个页面的平均时间为5ms。如果快表的命中率为75%，缺页中断率为10%，忽略快表访问时间，试求内存的有效存取时间。

> **答：**快表命中率为75%，缺页中断率为10%，所以，内存命中率为15%。
> 在快表：75%×1us(内存访问周期)×75%
> 在内存：15%×[1us(内存访问周期) + 1us(内存调入块表)]
> 在外存：10%×[1us(内存访问周期) + 1us(内存调入块表)+5000us(主外存传送一个页面)]
> 故内存的有效存取时间=1×75%+2×15%+(5000+2)×10%=501.25微秒。

## 26

假设某虚存的用户空间为1024KB，页面大小为4KB，内存空间为512KB。已知用户的10、11、12、13号虚页分得内存页框号为62、78、25、36，求出虚地址 0BEBCH（十六进制）的实地址（十六进制）。

> **答：**虚地址 0BEBC(16 进制 )的二进制形式为：0000 1011 1110 1011 1100。
> 由于页面大小为4KB ，故其中后12 位是内页地址：**0000 1011 <u>1110 1011 1100</u>**，由此可知虚地址的页号为：11（十进制）
> 查页表分得内存对应页框号为：78。
> 已知内存空间为512KB ，故内存共有128 个页框， 78 是合法物理块。
> 把78 化为 16 进制是 4E，虚地址 0BEBC(16 进制 )的实地址 (16 进制 )是： 4EEBC 。

29、考虑下列段表：

| 段号 | 起始地址 | 段长  |
| ---- | -------- | ----- |
| 0    | 2 0 0    | 5 0 0 |
| 1    | 8 9 0    | 3 0   |
| 2    | 1 2 0    | 1 0 0 |
| 3    | 1 2 5 0  | 6 0 0 |
| 4    | 1 8 0 0  | 8 8   |

对于下面的逻辑地址求物理地址，如发生越界请指明。（1）<0，480>；（2）<1，25>；（3）<1，14>;(4)<2，200>;(5)<3，500>;(6)<4，100>。

30、请页式虚存管理系统中，进程访问地址的序列为：10，11，104，170，73，305，180，240，244，445，467，366。试问：（1）如果页面大小为100B，给出页面访问序列。（3）若进程分得三个页框，采用FIFO和LRU替换算法，求缺页中断率。

 31、设程序大小为460个字，考虑如下访问序列：55，20，108，180，79，310，170，255，246，433，488，369。试问：（1）设页面大小为100个字，给出访问序列页面走向。（2）假设程序可用内存为200个字，采用FIFO、LRU和OPT淘汰算法，求出缺页中断率。

# 第六章

15、磁盘共有100个柱面，每个柱面有8个磁头，每个盘面分4个扇区。若逻辑记录与扇区等长，柱面、磁道、扇区均从0起编号。现用16位的200个字(0-199)来组成位示图来管理盘空间。现问：
(1)位示图第15个字的第7位为0而准备分配给某一记录，该块的柱面号、磁道号、扇区号是多少?
(2)现回收第56柱面第6磁道第3扇区，这时位示图的第几个字的第几位应清0?

> (1)
> ​    位示图第15个字的第7位对应的块号=15×16(字长)+7=247，而块号247对应的：
> ​    柱面号=247/(8×4)=7(从0编号，向下取整)
> ​    磁头号=(247 MOD 32)/4=5
> ​    扇区号=247 MOD 32 MOD 4=3
>
> (2)
> ​    块号=柱面号×柱面扇区数+磁道号×盘扇区+盘扇区=56×(8×4)+6×4+3=1819
> ​    字号=1819/16=113
> ​    位号=1819 MOD 16 =11
> ​    所以，回收第56柱面第6磁道第3扇区时，位示图的第113字的第11位应清0。



