16、一个经典的同步问题：吸烟者问题（Patil，1971年）。三名吸烟者在同一个房间内，还有一位香烟供应者。为了制造并抽掉香烟，每位吸烟者需要三样东西：烟草、纸和火柴，供应者有丰富的货物提供。三位吸烟者中，第一个人有自己的烟草，第二个人有自己的纸，第三个人有自己的火柴。供应者随机地将两样东西放在桌子上，允许一位吸烟者进行对健康不利的吸烟。当吸烟者完成吸烟后唤醒供应者，供应者再把两样东西放在桌子上，唤醒另一位吸烟者。试采用（1）信号量和PV操作、（2）管程，编写他们同步工作的程序。



23、设当前的系统状态如下，此时Available=(1,1,2)。

|      | Claim                                                       | Allocation                                                   |
| ---- | ----------------------------------------------------------- | ------------------------------------------------------------ |
| 进程 | R1                          R2                         R3   | R1                          R2                         R3    |
| P1   | 3                             2                           2 | 1                            0                             0 |
| P2   | 6                             1                           3 | 5                            1                             1 |
| P3   | 3                             1                           4 | 2                            1                             1 |
| P4   | 4                             2                           2 | 0                            0                             2 |

（1）计算各个进程还需要的资源数Cki-Aki

（2）系统是否处于安全状态，为什么？

（3）进程P2发出请求向量 request2（1，0，1），系统能把资源分配给它吗？

（4）若在进程P2申请资源后，P1发出请求向量 request1（1，0，1），系统能把资源分配给它吗？

（5）若在进程P1申请资源后，P3发出请求向量 request3（0，0，1），系统能把资源分配给它吗？



25、把死锁检测算法用于下面的数据：
$$
Need=
 \begin{array}{|ccc|}
      1 & 1 & 0 &0 \\
      0& 1 & 1 &2 \\
      3 & 1 & 0 &0 \\
      0 & 0 & 1 &0 \\
      2 & 1 & 1 &0\\
    \end{array}
$$

$$
Allocation=
 \begin{array}{|ccc|}
      3 & 0 & 1 &1 \\
      0& 1 & 0 &0\\
      1 & 1 & 1 &0 \\
      1 & 1& 0&1 \\
       0 & 0 & 0 &0\\
    \end{array}
$$

​                                                                          Allocation  = (1,0,2,0)

（1）系统此时处于安全状态吗？（2）若第二个进程提出资源请求request2（0，0，1，0），系统能分配资源给它吗？

（3）若第五个进程提出资源请求request5（0，0，1，0），系统能分配资源给它吗？



26、考虑一个共有150个存储单元的系统，按如下方式分配给三个进程，P1最大需求70个，已占有25个；P2最大需求60个，已占有40个；P3最大需求60个，已占有45个。使用银行家算法以确定下面的任何一个请求是否安全：（1）进程P4到达，P4最大需求60个，最初请求25个。（2）进程P4到达，P4最大需求60个，最初请求35个。如果安全，请找出安全序列；如果不安全，请给出结果的分配情况。



31、独木桥问题1：东西向汽车驶过独木桥，为了保证交通安全，只要桥上无车，则允许一方的汽车过桥，待其全部过完后才允许另一方的汽车过桥。请用信号量和PV操作写出汽车过独木桥问题的同步算法。



32、独木桥问题2：在独木桥问题1中，限制桥面上最多可以有k辆汽车通过。试用信号量和PV操作写出汽车过独木桥问题的同步算法。




37、某工厂有两个生产车间和一个装配车间，两个生产车间分别生产A、B两种零件，装配车间的任务是把A、B两种零件组装成产品。两个生产车间每生产一个零件后都要分别把它们送到装配车间的货架F1、F2上，F1存放零件A，F2放零件B，F1和F2的容量均为可以存放10个零件。装配工人每次从货架上取一个A零件和一个B零件，然后将其组装成产品。请用：（1）信号量和PV操作进行正确管理；（2）管程进行正确管理。



38，桌上有一只盘子，最多可以容纳两个水果，每次仅能放入或取出一个水果。爸爸向盘子中放苹果（ apple），妈妈向盘子中放橘子（orange），两个儿子专等吃盘子里的橘子，两个女儿专等吃盘子里的苹果。试用（1）信号量和PV操作、（2）管程，来实现爸爸、妈妈、儿子、女儿间的同步与互斥关系。



43、现有三个生产者P1、P2、P3，他们都要生产橘子汁，每个生产者都已分别购得两种不同的原料，待购齐第三种原料后就可配制成橘子汁装瓶出售。有一供应商能源源不断地供应糖、水、橘子精，但每次只拿出一种原料放入容器中供应给生产者。当容器中有原料时，需要这种原料的生产者可以取走，当容器空时供应商又可放入一种原料。假定：生产者P1已购得糖和水；生产者P2已购得水和橘子精；生产者P3已购得糖和橘子精。试用（1）管程、（2）信号量与PV操作，写出供应商和三个生产者之间能正确同步的程序。